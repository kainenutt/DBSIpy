; Minimal, engine-agnostic template config.
; Goal: run out-of-the-box after setting the required [INPUT] paths.
; Switch engines by changing: [GLOBAL] model_engine

[INPUT]
dwi_file =
mask_file =
bval_file =
bvec_file =

[OPTIMIZER]
step_1_lr = 0.001
step_1_epochs = 100
step_1_loss_fn = mse
step_2_lr = 0.001
step_2_epochs = 250
step_2_loss_fn = mse
; Step 2 early stopping (DBSI/IA only)
step_2_patience = 100
step_2_min_delta = 0.0

[DEBUG]
verbose = False

[GLOBAL]
; model_engine options: DBSI, IA, DTI, or NODDI
model_engine = IA
max_group_number = 1
fiber_threshold = 0.04
output_map_set = default
; dti_bval_cut: Maximum b-value (s/mm²) for DTI fitting (for comparison)
dti_bval_cut = 1500
; signal_normalization options: auto | max | b0 | minb | none
signal_normalization = auto
; learnable_s0: reserved for DBSI/IA; ignored for DTI/NODDI
learnable_s0 = False

[STEP_1]
angle_threshold = 40
; Basis paths are relative to dbsipy/configs/
angle_basis = BasisSets/Human_Brain_InVivo_Modern/angle_basis.csv
iso_basis = BasisSets/Human_Brain_InVivo_Modern/iso_basis.csv
step_1_axial = 0.002
step_1_radial = 0.0001

[STEP_2]
step_2_axials = BasisSets/Human_Brain_InVivo_Modern/axial_basis.csv
step_2_radials = BasisSets/Human_Brain_InVivo_Modern/radial_basis.csv
intra_threshold = 0.0001

[ISOTROPIC]
highly_restricted_threshold =
restricted_threshold = 3e-4
free_water_threshold = 3e-3

[NODDI]
# NODDI Optimizer Settings
noddi_lr = 0.001
noddi_epochs = 500
# Fixed Parameters (typical literature values)
# Units: mm²/s
noddi_d_ic = 0.0017
noddi_d_iso = 0.003
noddi_use_tortuosity = True

[DTI]
; dti_fit_method: WLS | OLS | ADAM
;   WLS/OLS are fast linear fits.
;   ADAM runs an iterative optimizer (uses dti_lr and dti_epochs below).
dti_fit_method = WLS
; dti_lr: ADAM learning rate (ignored for WLS/OLS)
dti_lr = 0.01
; dti_epochs: ADAM epochs (ignored for WLS/OLS)
dti_epochs = 200

[DEVICE]
# Compute device selection
# - auto: use cuda if available else cpu
# - cuda: request GPU (falls back to cpu if unavailable)
# - cpu: force CPU
DEVICE = auto
HOST = cpu
